### Generated by AI
This is just a script for a solution I created with AI. I want to share it with anyone who has the same problem as me, and I do not claim any credit.

# Force Gemini CLI to Always Activate a Skill on Startup

If you use heavy workflow skills in Gemini CLI (like a custom `using-superpowers` or `test-driven-development` skill), relying on the AI to remember to load them via system prompts can be flaky. Sometimes the agent just forgets and skips straight to answering your question.

This script provides a robust, program-level solution using Gemini CLI's **Hook System**. It automatically locks the session and forces the CLI to call the `activate_skill` tool on the very first turn of every new chat, guaranteeing your workflow rules are loaded before a single line of code is written.

## The Solution

We use a `BeforeToolSelection` hook. On the first turn of a new session, the hook intercepts the request and overrides the AI's `toolConfig`, forcing it into `"mode": "ANY"` while exclusively whitelisting the `activate_skill` tool. It also drops a lock file in the `~/.gemini/tmp/` directory so the hook gets out of the way for the rest of the session.

## ðŸš€ One-Step Installation Script

You can install this automatically using the Node.js script below. By default, it installs the hook globally into your `~/.gemini/` directory, meaning it will protect all projects on your machine.

Run the global installation script with:

```bash
node install-hook.js
```

**Project-Specific Installation:**
If you have Gemini installed locally within a specific project and want to commit this hook to your repository for your team, you can use the `--local` flag. This will install the hook into the current directory's `./.gemini/` folder instead.

```bash
node install-hook.js --local
```

### How to use it
Once installed, the system handles the rest. Just make sure your global instructions (`~/.gemini/GEMINI.md`) contain a simple line telling the AI *which* skill it should prioritize, for example:
> *"Always activate the 'using-superpowers' skill before starting any task."*

The hook forces the AI to open the toolbox, and your instructions tell it which tool to grab.

## ðŸ§ª Testing the Script

If you want to verify that the script executes correctly without modifying your host system, you can use the included isolated Docker test. This builds an Alpine Node container, creates a mock home directory, and verifies the installation inside the container.

You need Docker installed and running. Run the following command:

```bash
./run-container-test.sh
```

> **Note:** If you encounter a "permission denied" error, you may need to run the script with `sudo ./run-container-test.sh` or [add your user to the `docker` group](https://docs.docker.com/engine/install/linux-postinstall/).

